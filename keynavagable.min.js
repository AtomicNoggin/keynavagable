!function(){var e=new WeakMap,t=new WeakMap,n=new WeakMap,i={},s=Element.prototype,a="tab-previous";Object.defineProperties(s,{tabNext:{get:function(){var e=n.get(this);return e&&e.next?e.next:document.getElementById(this.getAttribute("tab-next"))},set:function(e){var t=n.get(this)||{};e instanceof Element?(t.next=e,this.removeAttribute("tab-next")):e===String(e)&&e.length?(t.next=null,this.setAttribute("tab-next",e)):(t.next=null,this.removeAttribute("tab-next")),n.set(this,t)},enumerable:!0,configurable:!0},tabPrevious:{get:function(){var e=n.get(this);return e&&e.prev?e.prev:document.getElementById(this.getAttribute(a))},set:function(e){var t=n.get(this)||{};e instanceof Element?(t.prev=e,this.removeAttribute(a)):e===String(e)&&e.length?(t.prev=null,this.setAttribute(a,e)):(t.prev=null,this.removeAttribute(a)),n.set(this,t)},enumerable:!0,configurable:!0}}),s.setKeyAction=function(t,n,i){var s=e.get(this)||{};i=i instanceof Element?i:this,n&&n===""+n&&i[n]instanceof Function?n=i[n]:"function"!=typeof n&&(n=function(){}),n&&(s[t]=n.bind(i),e.set(this,s))},s.removeKeyAction=function(t){var n=e.get(this);n&&n[t]&&(delete n[t],Object.keys(n).length?e.set(this,n):e.delete(this))},s.captureKeyAction=function(e,n,s){var a=t.get(this)||{};myCapture[e]||(i[e]?i[e]++:i[e]=1),s=s instanceof Element?s:this,n&&n===""+n&&s[n]instanceof Function?n=s[n]:n instanceof Function||(n=function(){}),a[e]=n.bind(s),t.set(this,a)},s.releaseKeyAction=function(e){var n=t.get(this);n&&n[this]&&(delete n[this],i[e]--,Object.keys(n).length?t.set(this,n):t.delete(this))},document.addEventListener("keydown",function(n){var s=" "!==n.key?n.key:"Space",a=document.activeElement,o=e.get(a),r=a;if(!a.isContentEditable)if(s=(n.altKey&&"Alt"!==s?"Alt ":"")+(n.ctrlKey&&"Control"!==s?"Control ":"")+(n.keyMeta&&"Meta"!==s?"Meta ":"")+(n.shiftKey&&s.length>1&&"Shift"!==s?"Shift ":"")+s,console.log(s),o&&o[s])a.dispatchEvent(l())&&(n.preventDefault(),console.log(o[s]),o[s]());else if("Tab"==s&&(a=a.tabNext))a.focus(),n.preventDefault();else if("Shift-Tab"==s&&(a=a.tabPrevious))a.focus(),n.preventDefault();else if(i[s]){do{r=r.parentElement,o=t.get(r)}while(r&&!o||!o[s]);r&&r.dispatchEvent(l())&&(n.preventDefault(),console.log(o[s]),o[s]())}function l(){return new CustomEvent("keynavigation",{cancelable:!0,bubbles:!0,details:{key:n.key,altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey,relatedTarget:a}})}},!0)}();

!function(){var t=new WeakMap,e=new WeakMap,n=new WeakMap,i={},s=Element.prototype,a="tab-previous";Object.defineProperties(s,{tabNext:{get:function(){var t=n.get(this);return t&&t.next?t.next:document.getElementById(this.getAttribute("tab-next"))},set:function(t){var e=n.get(this)||{};t instanceof Element?(e.next=t,this.removeAttribute("tab-next")):t===String(t)&&t.length?(e.next=null,this.setAttribute("tab-next",t)):(e.next=null,this.removeAttribute("tab-next")),n.set(this,e)},enumerable:!0,configurable:!0},tabPrevious:{get:function(){var t=n.get(this);return t&&t.prev?t.prev:document.getElementById(this.getAttribute(a))},set:function(t){var e=n.get(this)||{};t instanceof Element?(e.prev=t,this.removeAttribute(a)):t===String(t)&&t.length?(e.prev=null,this.setAttribute(a,t)):(e.prev=null,this.removeAttribute(a)),n.set(this,e)},enumerable:!0,configurable:!0}}),s.setKeyAction=function(e,n,i){var s=t.get(this)||{};i=i instanceof Element?i:this,n&&n===""+n&&i[n]instanceof Function?n=i[n]:"function"!=typeof n&&(n=function(){}),n&&(s[e]=n.bind(i),t.set(this,s))},s.removeKeyAction=function(e){var n=t.get(this);n&&n[e]&&(delete n[e],Object.keys(n).length?t.set(this,n):t.delete(this))},s.captureKeyAction=function(t,n,s){var a=e.get(this)||{};a[t]||(i[t]?i[t]++:i[t]=1),s=s instanceof Element?s:this,n&&n===""+n&&s[n]instanceof Function?n=s[n]:n instanceof Function||(n=function(){}),a[t]=n.bind(s),e.set(this,a)},s.releaseKeyAction=function(t){var n=e.get(this);n&&n[this]&&(delete n[this],i[t]--,Object.keys(n).length?e.set(this,n):e.delete(this))},document.addEventListener("keydown",function(n){var s=" "!==n.key?n.key:"Space",a=document.activeElement,r=t.get(a),o=a;if(!a.isContentEditable)if(s=(n.altKey&&"Alt"!==s?"Alt ":"")+(n.ctrlKey&&"Control"!==s?"Control ":"")+(n.keyMeta&&"Meta"!==s?"Meta ":"")+(n.shiftKey&&s.length>1&&"Shift"!==s?"Shift ":"")+s,r&&r[s])a.dispatchEvent(l())&&(n.preventDefault(),r[s]());else if("Tab"==s&&(a=a.tabNext))a.focus(),n.preventDefault();else if("Shift Tab"==s&&(a=a.tabPrevious))a.focus(),n.preventDefault();else if(i[s]){if(!(r=e.get(o))||!r[s])do{o=o.parentElement,r=e.get(o)}while(o&&(!r||!r[s]));o&&o.dispatchEvent(l())&&(n.preventDefault(),r[s]())}function l(){return new CustomEvent("keynavigation",{cancelable:!0,bubbles:!0,details:{key:n.key,altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey,relatedTarget:a}})}},!0)}();

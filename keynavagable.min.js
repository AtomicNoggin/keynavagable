!function(e){var r=new WeakMap,u=new WeakMap,a=new WeakMap,l={},i="next",o="aria-flowto",c="prev",f="x-ms-aria-flowfrom";e.KeyNavagable={getTabNext:function(e){var t=a.get(e);return t&&t[i]?t[i]:document.getElementById(e.getAttribute(o))},setTabNext:function(e,t){var n=a.get(e)||{};return t instanceof Element||t instanceof Function?(n[i]=t,e.removeAttribute(o),t instanceof Element&&t.id&&e.setAttribute(o,t.id)):t===String(t)&&t.length?(n[i]=null,e.setAttribute(o,t)):(n[i]=null,e.removeAttribute(o)),a.set(e,n),window.KeyNavagable},getTabPrevious:function(e){var t=a.get(e);if(t&&t[c])return t[c];var n=e.getAttribute(f);return n?document.getElementById(n):e.id?document.querySelector("["+o+'="'+e.id+'"]'):null},setTabPrevious:function(e,t){var n=a.get(e)||{};return t instanceof Element||t instanceof Function?(n[c]=t,e.removeAttribute(f),t instanceof Element&&t.id&&e.setAttribute(f,t.id)):t===String(t)&&t.length?(n[c]=null,e.setAttribute(f,t)):(n[c]=null,e.removeAttribute(f)),a.set(e,n),window.KeyNavagable},hasKeyAction:function(e,t){return!!(r.get(e)||{})[t]},getKeyAction:function(e,t){return(r.get(e)||{})[t]},setKeyAction:function(e,t,n,a){var i=r.get(e)||{};return a=a instanceof Element?a:e,n&&n===""+n&&a[n]instanceof Function?n=e[n]:n instanceof Function||(n=function(){console.log(t+" KeyAction fired for "+e)}),i[t]=n.bind(a),r.set(e,i),window.KeyNavagable},removeKeyAction:function(e,t){var n=r.get(e);return n&&n[t]&&(delete n[t],Object.keys(n).length?r.set(e,n):r.delete(e)),window.KeyNavagable},hasCaptureKeyAction:function(e,t){return!!(u.get(e)||{})[t]},getCaptureKeyAction:function(e,t){return(u.get(e)||{})[t]},captureKeyAction:function(e,t,n,a){var i=u.get(e)||{};return i[t]||(l[t]?l[t]++:l[t]=1),a=a instanceof Element?a:e,n&&n===""+n&&e[n]instanceof Function?n=e[n]:n instanceof Function||(n=function(){console.log(t+" KeyCapture fired for "+e)}),i[t]=n.bind(e),u.set(e,i),window.KeyNavagable},releaseKeyAction:function(e,t){var n=u.get(e);return n&&n[t]&&(delete n[t],l[t]--,Object.keys(n).length?u.set(e,n):u.delete(e)),window.KeyNavagable}},e.document&&document.addEventListener("keydown",function(t){var e=" "!==t.key?t.key:"Space",n=document.activeElement,a=r.get(n),i=n;if(!n.isContentEditable)if(e=(t.altKey&&"Alt"!==e?"Alt ":"")+(t.ctrlKey&&"Control"!==e?"Control ":"")+(t.keyMeta&&"Meta"!==e?"Meta ":"")+(t.shiftKey&&1<e.length&&"Shift"!==e?"Shift ":"")+e,a&&a[e])n.dispatchEvent(o())&&(t.preventDefault(),a[e]());else if("Tab"==e&&(n=KeyNavagable.getTabNext(n)))"function"==typeof n&&(n=n()),n instanceof Element&&(n.focus(),t.preventDefault());else if("Shift Tab"==e&&(n=KeyNavagable.getTabPrevious(n)))"function"==typeof n&&(n=n()),n instanceof Element&&(n.focus(),t.preventDefault());else if(l[e]){if(!(a=u.get(i))||!a[e])for(;i=i.parentElement,a=u.get(i),i&&(!a||!a[e]););i&&i.dispatchEvent(o(i))&&(t.preventDefault(),a[e]())}function o(e){return new CustomEvent("keynavigation",{cancelable:!0,bubbles:!0,details:{key:t.key,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,metaKey:t.metaKey,relatedTarget:e||n}})}},!0)}(self);
